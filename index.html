<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>和英正順アプリ</title>
  <link rel="stylesheet" href="style.css">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
</head>
<body>
  <header class="app-header">
    <h1>和英正順アプリ</h1>
  </header>

  <nav class="tabs">
    <button class="tab-btn active" data-tab="practice">練習</button>
    <button class="tab-btn" data-tab="problems">問題</button>
    <button class="tab-btn" data-tab="catalog">問題一覧</button>
    <button class="tab-btn" data-tab="history">履歴</button>
    <button class="tab-btn" data-tab="settings">設定</button>
  </nav>

  <main>
    <!-- Practice Tab -->
    <section id="practice" class="tab active">
      <div class="controls-row">
        <button id="prevBtn" class="nav-btn">前へ</button>
        <button id="nextBtn" class="nav-btn">次へ</button>
        <button id="speakBtn" class="tts-btn">日本語→英語 読み上げ</button>
        <button id="checkBtn" class="check-btn">Check</button>
        <button id="resetBtn" class="secondary">リセット</button>
      </div>

      <div id="delaysInfo" class="hint"></div>

      <div id="qaArea" class="qa-area">
        <div class="jp bold" id="jpText">「問題」タブでデータセットを選んでください。</div>
        <div class="bank-and-answer">
          <div class="word-bank" id="wordBank" aria-label="単語候補"></div>
          <div class="answer-area" id="answerArea" aria-label="解答欄"></div>
        </div>
        <div class="result" id="resultBox"></div>
        <div class="explain" id="explainBox"></div>
      </div>
    </section>

    <!-- Problems Tab -->
    <section id="problems" class="tab">
      <h2>CSVアップロード（入れ子フォルダ対応）</h2>
      <p class="hint">CSV 形式: 1列目=日本語(jp), 2列目=英語(en), 3列目=解説(ex)。ヘッダー jp,en,ex を推奨。</p>
      <label class="block">フォルダ（例: 医療/ALT/基礎）:
        <input type="text" id="folderPath" placeholder="フォルダ/サブフォルダ">
      </label>
      <div class="flex-row gap">
        <input type="file" id="csvFiles" accept=".csv" multiple>
        <button id="uploadCsvBtn">アップロード</button>
      </div>
      <div id="uploadLog" class="log"></div>

      <h3>データセット一覧（タップで練習開始）</h3>
      <div id="datasetList" class="dataset-list"></div>
    </section>

    <!-- Catalog Tab -->
    <section id="catalog" class="tab">
      <h2>問題一覧（データセットの連続読み上げ）</h2>
      <div class="dataset-picker">
        <h3>データセット選択</h3>
        <div id="catalogTree" class="tree"></div>
      </div>
      <div class="controls-row">
        <button id="catalogPlayAll" class="primary">選択データセットを連続再生</button>
        <button id="catalogStop" class="secondary">停止</button>
      </div>
      <div id="catalogStatus" class="hint"></div>
      <div id="catalogList" class="history-list"></div>
    </section>

    <!-- History Tab -->
    <section id="history" class="tab">
      <div class="controls-row">
        <button id="clearHistBtn" class="secondary">履歴を全削除</button>
      </div>
      <div id="historyList" class="history-list"></div>
    </section>

    <!-- Settings Tab -->
    <section id="settings" class="tab">
      <h2>読み上げ設定</h2>
      <div class="grid-2">
        <label>日本語→英語の遅延（秒, 0.5〜10）
          <input type="number" id="delayJaToEn" min="0.5" max="10" step="0.5" value="1.0">
        </label>
        <label>次の日本語開始までの遅延（秒, 0.5〜10）
          <input type="number" id="delayBetweenQs" min="0.5" max="10" step="0.5" value="1.0">
        </label>
      </div>
      <div class="grid-2">
        <label>日本語音声
          <select id="jaVoice"></select>
        </label>
        <label>英語音声
          <select id="enVoice"></select>
        </label>
      </div>
      <button id="saveSettingsBtn" class="primary">保存</button>
      <div id="settingsSaved" class="hint"></div>
    </section>
  </main>

  <footer class="app-footer">
    <span>© 和英正順アプリ</span>
  </footer>

  <script src="app.js"></script>
</body>
</html>
